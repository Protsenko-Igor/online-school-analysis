# SQL-запросы для анализа

В этой папке находятся SQL-запросы, которые формируют аналитическую логику проекта.

## Структура файлов

### Основные агрегирующие запросы
1. **`sales_funnel_aggregation.sql`** - построение воронки продаж от клика до продажи с расчетом метрик (CPO, CR, ROMI)
2. **`retention_cohort_aggregation.sql`** - формирование когорт для анализа retention, вовлеченности в уроки и выполнения ДЗ

## Используемые технологии
- **Язык:** YQL (Yandex Query Language)
- **Платформа:** Yandex Query в Yandex Cloud
- **Особенности:** Использование оконных функций (ROW_NUMBER), подзапросы в FROM, агрегации по нескольким измерениям

## Порядок выполнения
Запросы выполнялись в следующем порядке:
1. Загрузка сырых CSV из Object Storage во внешние таблицы
2. Создание материализованных представлений для оптимизации
3. Выполнение агрегирующих запросов с сохранением результатов обратно в Object Storage
4. Использование агрегированных данных для построения дашбордов в DataLens
